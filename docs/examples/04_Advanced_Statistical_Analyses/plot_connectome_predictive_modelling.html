
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="../../_static/javascripts/modernizr.js"></script>
  
  
  
    <title>Connectome Predictive Modelling &#8212; ConPagnon 2.0</title>
    <link rel="stylesheet" href="../../_static/material.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Manipulation of the data dictionary" href="../05_utilities/plot_selection_of_data.html" />
    <link rel="prev" title="Discriminative connection identification" href="plot_discriminative_connection_identification.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=red data-md-color-accent=blue>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#examples/04_Advanced_Statistical_Analyses/plot_connectome_predictive_modelling" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../../index.html" title="ConPagnon 2.0"
           class="md-header-nav__button md-logo">
          
              <img src="../../_static/logo_conpagnon_small_header.png" height="26"
                   alt="ConPagnon 2.0 logo">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">ConPagnon 2.0</span>
          <span class="md-header-nav__topic"> Connectome Predictive Modelling </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../../search.html" method="GET" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/ConPagnon/conpagnon" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    ConPagnon
  </div>
</a>
          </div>
        </div>
      
      
  
  <script src="../../_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = "../../_static/versions.json",
        target_loc = "../../../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="../index.html" class="md-tabs__link">ConPagnon usage examples</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../../index.html" title="ConPagnon 2.0" class="md-nav__button md-logo">
      
        <img src="../../_static/logo_conpagnon_small_header.png" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../../index.html"
       title="ConPagnon 2.0">ConPagnon 2.0</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/ConPagnon/conpagnon" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    ConPagnon
  </div>
</a>
    </div>
  
  

  
  
  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
      <a href="../../install.html" class="md-nav__link">Installing ConPagnon</a>
      
    </li>
    <li class="md-nav__item">
    
      <a href="../../contributing.html" class="md-nav__link">Contributing to ConPagnon</a>
      
    </li>
    <li class="md-nav__item">
    
      <a href="../index.html" class="md-nav__link">ConPagnon usage examples</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
      <a href="../index.html#tutorial-examples" class="md-nav__link">Tutorial examples</a>
      
    </li>
    <li class="md-nav__item">
    
      <a href="../index.html#organization-of-data-for-conpagnon" class="md-nav__link">Organization of data for ConPagnon</a>
      
    </li>
    <li class="md-nav__item">
    
      <a href="../index.html#functional-connectivity-computing" class="md-nav__link">Functional Connectivity: Computing</a>
      
    </li>
    <li class="md-nav__item">
    
      <a href="../index.html#basic-statistical-analyses" class="md-nav__link">Basic Statistical Analyses</a>
      
    </li>
    <li class="md-nav__item">
    
      <a href="../index.html#advanced-statistical-analyses" class="md-nav__link">Advanced Statistical Analyses</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
      <a href="plot_individual_statistics_in_the_tangent_space.html" class="md-nav__link">Statistics in the tangent space</a>
      
    </li>
    <li class="md-nav__item">
    
      <a href="plot_discriminative_connection_identification.html" class="md-nav__link">Discriminative connection identification</a>
      
    </li>
    <li class="md-nav__item">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    <label class="md-nav__link md-nav__link--active" for="__toc"> Connectome Predictive Modelling </label>
    
      <a href="#" class="md-nav__link md-nav__link--active">Connectome Predictive Modelling</a>
      
        

<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#examples-04-advanced-statistical-analyses-plot-connectome-predictive-modelling--page-root" class="md-nav__link">Connectome Predictive Modelling</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#retrieve-the-example-dataset" class="md-nav__link">Retrieve the example dataset</a>
        </li>
        <li class="md-nav__item"><a href="#module-import" class="md-nav__link">Module import</a>
        </li>
        <li class="md-nav__item"><a href="#load-data-and-set-path" class="md-nav__link">Load data, and set Path</a>
        </li>
        <li class="md-nav__item"><a href="#connectome-predictive-modelling-the-algorithm" class="md-nav__link">Connectome Predictive Modelling: the algorithm</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#step-1-features-selections" class="md-nav__link">Step 1: Features selections</a>
        </li>
        <li class="md-nav__item"><a href="#step-2-features-summarization" class="md-nav__link">Step 2: Features summarization</a>
        </li>
        <li class="md-nav__item"><a href="#step-3-build-the-linear-model" class="md-nav__link">Step 3: Build the linear model</a>
        </li>
        <li class="md-nav__item"><a href="#step-4-repeat-and-prediction-evaluation" class="md-nav__link">Step 4: Repeat and prediction evaluation</a>
        </li>
        <li class="md-nav__item"><a href="#step-5-assessment-of-prediction-significance" class="md-nav__link">Step 5: Assessment of prediction significance</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#visualize-null-distribution-and-selected-features" class="md-nav__link">Visualize null distribution, and selected features</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../../_sources/examples/04_Advanced_Statistical_Analyses/plot_connectome_predictive_modelling.rst.txt">Show Source</a> </li>

  </ul>
</nav>
    </li></ul>
    </li>
    <li class="md-nav__item">
    
      <a href="../index.html#utilities" class="md-nav__link">Utilities</a>
      
    </li></ul>
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                

<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#examples-04-advanced-statistical-analyses-plot-connectome-predictive-modelling--page-root" class="md-nav__link">Connectome Predictive Modelling</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#retrieve-the-example-dataset" class="md-nav__link">Retrieve the example dataset</a>
        </li>
        <li class="md-nav__item"><a href="#module-import" class="md-nav__link">Module import</a>
        </li>
        <li class="md-nav__item"><a href="#load-data-and-set-path" class="md-nav__link">Load data, and set Path</a>
        </li>
        <li class="md-nav__item"><a href="#connectome-predictive-modelling-the-algorithm" class="md-nav__link">Connectome Predictive Modelling: the algorithm</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#step-1-features-selections" class="md-nav__link">Step 1: Features selections</a>
        </li>
        <li class="md-nav__item"><a href="#step-2-features-summarization" class="md-nav__link">Step 2: Features summarization</a>
        </li>
        <li class="md-nav__item"><a href="#step-3-build-the-linear-model" class="md-nav__link">Step 3: Build the linear model</a>
        </li>
        <li class="md-nav__item"><a href="#step-4-repeat-and-prediction-evaluation" class="md-nav__link">Step 4: Repeat and prediction evaluation</a>
        </li>
        <li class="md-nav__item"><a href="#step-5-assessment-of-prediction-significance" class="md-nav__link">Step 5: Assessment of prediction significance</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#visualize-null-distribution-and-selected-features" class="md-nav__link">Visualize null distribution, and selected features</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../../_sources/examples/04_Advanced_Statistical_Analyses/plot_connectome_predictive_modelling.rst.txt">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-examples-04-advanced-statistical-analyses-plot-connectome-predictive-modelling-py"><span class="std std-ref">here</span></a> to download the full example code</p>
</div>

<span id="sphx-glr-examples-04-advanced-statistical-analyses-plot-connectome-predictive-modelling-py"></span><h1 id="examples-04-advanced-statistical-analyses-plot-connectome-predictive-modelling--page-root">Connectome Predictive Modelling<a class="headerlink" href="#examples-04-advanced-statistical-analyses-plot-connectome-predictive-modelling--page-root" title="Permalink to this headline">¶</a></h1>
<p><strong>What you’ll learn</strong>: Build a linear model from functional
connectivity matrices to predict a continuous behavioral
variable.</p>
<p><strong>Author</strong>: <a class="reference external" href="mailto:dhaif%40dhaifbekha.com">Dhaif BEKHA</a></p>

<h2 id="retrieve-the-example-dataset">Retrieve the example dataset<a class="headerlink" href="#retrieve-the-example-dataset" title="Permalink to this headline">¶</a></h2>
<p>In this example, we will work directly on a pre-computed dictionary,
that contain two set of connectivity matrices, from two different groups.
The first group, called <em>controls</em> is a set of connectivity matrices from healthy
seven years old children, and the second group called <em>patients</em>, is a set of
connectivity matrices from seven years old children who have suffered a stroke.
You can download the dictionary use in this example
<a class="reference external" href="https://www.dropbox.com/s/kwdrx4liauo10kr/raw_subjects_connectivity_matrices.pkl?dl=1">here</a>.
In this example we will try to predict a continuous variable from the connectivity matrices. Therefore, you
can also download a
<a class="reference external" href="https://www.dropbox.com/scl/fi/w5mxeel9ihmlksxfz88or/regression_data.xlsx?dl=1&amp;rlkey=3srxro9jm8k0e2asbwfetxnjl">table</a>
, containing one behavioral variable for all subject in the patients group.</p>


<h2 id="module-import">Module import<a class="headerlink" href="#module-import" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">conpagnon.utils.folders_and_files_management</span> <span class="kn">import</span> <span class="n">load_object</span>
<span class="kn">from</span> <span class="nn">conpagnon.machine_learning.CPM_method</span> <span class="kn">import</span> <span class="n">predictors_selection_correlation</span><span class="p">,</span> \
    <span class="n">compute_summary_subjects_summary_values</span><span class="p">,</span> <span class="n">fit_model_on_training_set</span><span class="p">,</span> <span class="n">predict_behavior</span>
<span class="kn">from</span> <span class="nn">conpagnon.plotting.display</span> <span class="kn">import</span> <span class="n">plot_matrix</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">nilearn.connectome</span> <span class="kn">import</span> <span class="n">sym_matrix_to_vec</span><span class="p">,</span> <span class="n">vec_to_sym_matrix</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">joblib</span> <span class="kn">import</span> <span class="n">delayed</span><span class="p">,</span> <span class="n">Parallel</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>


<h2 id="load-data-and-set-path">Load data, and set Path<a class="headerlink" href="#load-data-and-set-path" title="Permalink to this headline">¶</a></h2>
<p>For this section of the tutorial, we will simply need a set
of connectivity matrices, and a continuous behavioral score.
Traditionally a score is simply a measure of an individual performance
for a particular cognitive task. In our case,
for this simple example, this score
will be interpreted as the mean performance
for a battery of sub-test regarding the language function.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fetch the path of the home directory</span>
<span class="n">home_directory</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="o">.</span><span class="n">home</span><span class="p">())</span>

<span class="c1"># Load the dictionary containing the connectivity matrices</span>
<span class="n">subjects_connectivity_matrices</span> <span class="o">=</span> <span class="n">load_object</span><span class="p">(</span>
    <span class="n">full_path_to_object</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">home_directory</span><span class="p">,</span> <span class="s1">'raw_subjects_connectivity_matrices.pkl'</span><span class="p">))</span>

<span class="c1"># Load the data table</span>
<span class="n">data_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">home_directory</span><span class="p">,</span> <span class="s1">'regression_data.xlsx'</span><span class="p">)</span>
<span class="n">data_table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">data_path</span><span class="p">)</span>

<span class="c1"># Print the data table</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data_table</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>|    | subjects       |   language_performance |
|---:|:---------------|-----------------------:|
|  0 | sub04_rc110343 |               1.00484  |
|  1 | sub06_ml110125 |               3.83867  |
|  2 | sub07_lc110496 |              -0.907201 |
|  3 | sub08_jl110342 |              -4.26892  |
|  4 | sub10_dl120547 |              -0.957913 |
|  5 | sub12_ab110489 |               3.21885  |
|  6 | sub13_vl110480 |              -0.331407 |
|  7 | sub14_rs120006 |              -1.05699  |
|  8 | sub17_eb120007 |               2.88928  |
|  9 | sub20_hd120032 |              -5.33207  |
| 10 | sub21_yg120001 |              -1.56495  |
| 11 | sub23_lf120459 |               3.80515  |
| 12 | sub24_ed110159 |             -10.4086   |
| 13 | sub25_ec110149 |               1.78148  |
| 14 | sub26_as110192 |              -3.93445  |
| 15 | sub30_zp130008 |               1.42485  |
| 16 | sub32_mp130025 |              -1.2626   |
| 17 | sub34_jc130100 |               1.37514  |
| 18 | sub35_gc130101 |               3.66906  |
| 19 | sub37_la130266 |               3.77187  |
| 20 | sub38_mv130274 |               2.17901  |
| 21 | sub39_ya130305 |               1.08922  |
| 22 | sub41_sa130332 |               1.80184  |
| 23 | sub43_mc130373 |               2.01819  |
| 24 | sub44_av130474 |              -3.84236  |
</pre></div>
</div>


<h2 id="connectome-predictive-modelling-the-algorithm">Connectome Predictive Modelling: the algorithm<a class="headerlink" href="#connectome-predictive-modelling-the-algorithm" title="Permalink to this headline">¶</a></h2>
<p>Connectome Predictive Modelling (<strong>CPM</strong>), is fairly new
simple algorithm for the prediction of behavioral scores
developed by <em>Shen et al</em> and explain in
detailed in their <a class="reference external" href="https://www.nature.com/articles/nprot.2016.178">paper</a>.
In this section, we will detailed the main steps of this algorithm
before diving into the Python implementation that you’ll find in ConPagnon.
CPM, is a data driven method with the aim of building
predictive models for the brain-behavior relationship using
the well known method of cross-validation.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>We detailed the main steps of the CPM algorithm, but
in practice we build a function which wrap all
the necessary step, including the cross validation.
Indeed, all the steps we will see below are wrapped
in a loop, the <strong>cross validation loop</strong>, in which
we repeat all the steps on the <strong>training set</strong>. The
cross validation method for CPM is <strong>Leave-One-out</strong>,
meaning that, at each iteration, a subject is taking
away from the dataset, and the rest of it, is the
training set. For simplicity, we will detailed the steps
of the CPM method, for one iteration only, i.e, one
split of the dataset, until the step 4, in which
we will finally run the entire prediction process.</p>
</div>

<h3 id="step-1-features-selections">Step 1: Features selections<a class="headerlink" href="#step-1-features-selections" title="Permalink to this headline">¶</a></h3>
<p>Traditionally, functional connectivity are high
dimensional matrices, and the number of connectivity
coefficient (<strong>features</strong>, in the machine learning field),
are often far more superior than the number of subjects in your
study. That ratio, affect in a very negative way the performance
of machine learning predictive models. This is often called the
<strong>cursed of dimensionality</strong>. One very popular way to reduce this
effect and increase the accuracy of prediction, is to carefully
<strong>select features</strong> before feeding them to a model. In the CPM algorithm,
the very first step is a features selection step. There is various
way to pre-select the features, but the most simple is to compute
the linear <strong>correlation between the functional connectivity and
the behavioral variable</strong>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let's compute the correlation between the language performance</span>
<span class="c1"># and functional connectivity for the correlation metric.</span>

<span class="c1"># Fetch the subjects list from the data table</span>
<span class="n">data_table</span> <span class="o">=</span> <span class="n">data_table</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">'subjects'</span><span class="p">)</span>
<span class="n">subjects_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">data_table</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

<span class="c1"># Stack the connectivity matrices, following</span>
<span class="c1"># the subjects_list</span>
<span class="n">patients_correlation_matrices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">subjects_connectivity_matrices</span><span class="p">[</span><span class="s1">'patients'</span><span class="p">][</span><span class="n">s</span><span class="p">][</span><span class="s1">'correlation'</span><span class="p">]</span>
                                          <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">subjects_list</span><span class="p">])</span>
<span class="n">vectorized_correlation_matrices</span> <span class="o">=</span> <span class="n">sym_matrix_to_vec</span><span class="p">(</span><span class="n">symmetric</span><span class="o">=</span><span class="n">patients_correlation_matrices</span><span class="p">,</span>
                                                    <span class="n">discard_diagonal</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'We have </span><span class="si">{}</span><span class="s1"> observations (i.e, number of subjects), '</span>
      <span class="s1">'and </span><span class="si">{}</span><span class="s1"> features (i.e connectivity coefficients).'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">vectorized_correlation_matrices</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                                                <span class="n">vectorized_correlation_matrices</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

<span class="c1"># Split the dataset into training set and test test</span>
<span class="c1"># using the leave one out cross-validation scheme:</span>
<span class="c1"># training set, test set for the connectivity matrices:</span>
<span class="n">training_correlation_matrices</span> <span class="o">=</span> <span class="n">vectorized_correlation_matrices</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">test_correlation_matrix</span> <span class="o">=</span> <span class="n">vectorized_correlation_matrices</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span>

<span class="c1"># training set, test for the language performance:</span>
<span class="c1"># We put all the language scores in a (n_subjects, 1) vector</span>
<span class="c1"># for convenience, because the function that we will call</span>
<span class="c1"># for computing the correlation only accept that shape.</span>
<span class="n">language_performance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">subjects_list</span><span class="p">),</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">language_performance</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data_table</span><span class="p">[</span><span class="s1">'language_performance'</span><span class="p">])</span>

<span class="n">training_language_scores</span> <span class="o">=</span> <span class="n">language_performance</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">test_language_score</span> <span class="o">=</span> <span class="n">language_performance</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">'We will train the CPM algorithm on </span><span class="si">{}</span><span class="s1"> subjects and test the CPM model on </span><span class="si">{}</span><span class="s1"> subject'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
    <span class="n">training_correlation_matrices</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">test_correlation_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="p">))</span>

<span class="c1"># Finally, we compute the correlation between the</span>
<span class="c1"># language performance and the functional connectivity</span>

<span class="c1"># Correlation between the language performance and connectivity</span>
<span class="c1"># coefficients on the training set.</span>
<span class="n">r_matrix</span><span class="p">,</span> <span class="n">p_matrix</span> <span class="o">=</span> <span class="n">predictors_selection_correlation</span><span class="p">(</span>
    <span class="n">training_connectivity_matrices</span><span class="o">=</span><span class="n">training_correlation_matrices</span><span class="p">,</span>
    <span class="n">training_set_behavioral_scores</span><span class="o">=</span><span class="n">training_language_scores</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>We have 25 observations (i.e, number of subjects), and 2556 features (i.e connectivity coefficients).
We will train the CPM algorithm on 24 subjects and test the CPM model on 1 subject
</pre></div>
</div>
<p>As expected, the correlation is simply a vector of
correlation values, and we also compute the corresponding
p-values for each connectivity coefficients. Finally, we
want to select the edges in our connectivity matrices with
a p-value below a certain threshold, usually, 0.05, or 0.01.
This final step is wrapped in a function in the next section.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The correlation is not the only way of selecting
features. You may want to select features by also
adding <strong>confounding variables</strong>, and in that case
the <em>partial correlation</em> is more appropriate. Or
you have multiple variables, with a simple <strong>linear model</strong>
as a pre-selection step. Please, see the doctring of the
<a class="reference internal" href="../../conpagnon.machine_learning.html#conpagnon.machine_learning.CPM_method.predictor_selection_pcorrelation" title="conpagnon.machine_learning.CPM_method.predictor_selection_pcorrelation"><code class="xref py py-func docutils literal notranslate"><span class="pre">conpagnon.machine_learning.CPM_method.predictor_selection_pcorrelation()</span></code></a> and
<a class="reference internal" href="../../conpagnon.machine_learning.html#conpagnon.machine_learning.CPM_method.predictors_selection_linear_model" title="conpagnon.machine_learning.CPM_method.predictors_selection_linear_model"><code class="xref py py-func docutils literal notranslate"><span class="pre">conpagnon.machine_learning.CPM_method.predictors_selection_linear_model()</span></code></a> functions.</p>
</div>
<p>The selection step done, we can now move to the second step which is the <strong>features
summarization</strong>.</p>


<h3 id="step-2-features-summarization">Step 2: Features summarization<a class="headerlink" href="#step-2-features-summarization" title="Permalink to this headline">¶</a></h3>
<p>In this step, we will call the function that select the edges with
a p-value below a user defined threshold, and we will condense the
surviving edges in two values, for each subject, called <strong>summary values</strong>.
Indeed, when the correlation is computed, some edges are naturally <strong>positively</strong>
correlated with the behavioral score, and some edges are <strong>negatively</strong> correlated
with the behavioral score. The idea here, is to compute the linear <strong>sum</strong> for each
subject for the positively correlated edges in one hand, and the negatively correlated
edges in the other hand. Let’s called those quantities <span class="math notranslate nohighlight">\({ \sum_{+}^{}}{}\)</span> and
<span class="math notranslate nohighlight">\({ \sum_{-}^{}}{}\)</span>. Now, a subject can be describe with only quantities:
<span class="math notranslate nohighlight">\({{ \sum_{+}^{}}{}, { \sum_{-}^{}}{}, languageScore}\)</span>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute the summary values, after selecting</span>
<span class="c1"># the surviving edges at a threshold of 0.05.</span>
<span class="n">negative_edges_mask</span><span class="p">,</span> <span class="n">positive_edges_mask</span><span class="p">,</span> <span class="n">negative_edges_summary_values</span><span class="p">,</span> \
           <span class="n">positive_edges_summary_values</span> <span class="o">=</span> <span class="n">compute_summary_subjects_summary_values</span><span class="p">(</span>
            <span class="n">training_connectivity_matrices</span><span class="o">=</span><span class="n">training_correlation_matrices</span><span class="p">,</span>
            <span class="n">significance_selection_threshold</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
            <span class="n">R_mat</span><span class="o">=</span><span class="n">r_matrix</span><span class="p">,</span>
            <span class="n">P_mat</span><span class="o">=</span><span class="n">p_matrix</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The above function compute non only the summary values, but also
two binary mask, one for the positively correlated edges, one for
the negatively correlated edges, storing the selected edges before
the computation of those summary values. It will be useful for
plotting purposes, to know which edges was selected !</p>
</div>


<h3 id="step-3-build-the-linear-model">Step 3: Build the linear model<a class="headerlink" href="#step-3-build-the-linear-model" title="Permalink to this headline">¶</a></h3>
<p>The third step in the CPM protocols, is to train
a linear model on the training set, with the summary
values computed above as the new features. Note that,
any additional variable can be added here, if you find
it relevant. The linear model can simply be written like
this, for the sum of selected positively correlated
edges:</p>
<div class="math notranslate nohighlight">
\[Behavior = \beta_0 + \beta_1*{ \sum_{+}^{}}{} + \mu_+\]</div>
<p>and for the for the sum of selected negatively correlated
edges:</p>
<div class="math notranslate nohighlight">
\[Behavior = \beta_0 + \beta_2*{ \sum_{-}^{}}{} + \mu_-\]</div>
<p>The drastic reduction in the features, from <code class="docutils literal notranslate"><span class="pre">2556</span></code> connectivity coefficient to only
2 features (the summary values, computed as the sum of the previously selected connectivity
coefficient) allow us to manipulate a very <strong>simple</strong> and <strong>classic linear model</strong>. As awe said
the cross validation method is Leave-One-Out, so as we have 25 subjects, we have 25 iterations
of the CPM method. For this example, we only detailed <strong>one iteration</strong>, so in the code below,
there is one and only call of the fitting of the linear model on the training set, follow
by the testing on the leftout subject.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fit the a linear model for the positively correlated edges with the behavior,</span>
<span class="c1"># and the negatively correlated edges with the behavior.</span>
<span class="n">positive_edge_model_fit</span><span class="p">,</span> <span class="n">negative_edge_model_fit</span> <span class="o">=</span> <span class="n">fit_model_on_training_set</span><span class="p">(</span>
    <span class="n">negative_edges_summary_values</span><span class="o">=</span><span class="n">negative_edges_summary_values</span><span class="p">,</span>
    <span class="n">positive_edges_summary_values</span><span class="o">=</span><span class="n">positive_edges_summary_values</span><span class="p">,</span>
    <span class="n">training_set_behavioral_score</span><span class="o">=</span><span class="n">training_language_scores</span><span class="p">,</span>
    <span class="n">add_predictive_variables</span><span class="o">=</span><span class="kc">None</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">positive_edge_model_fit</span></code>, <code class="docutils literal notranslate"><span class="pre">negative_edge_model_fit</span></code>
are two <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code> objects, one for the positive
summary values, and one for the negative summary values.
Those objects, contain the <code class="xref py py-func docutils literal notranslate"><span class="pre">predict()</span></code> method for
evaluating the model for a new score.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># We can test those linear models on the leftout</span>
<span class="c1"># subject. The first step is to compute the summary</span>
<span class="c1"># values for the leftout subject:</span>

<span class="c1"># Compute summary statistic for the left out subject</span>
<span class="n">test_subject_positive_edges_summary_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">test_correlation_matrix</span><span class="p">,</span>
                                                               <span class="n">positive_edges_mask</span><span class="p">))</span>
<span class="n">test_subject_negative_edges_summary_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">test_correlation_matrix</span><span class="p">,</span>
                                                               <span class="n">negative_edges_mask</span><span class="p">))</span>

<span class="n">test_subject_variable_positive_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">test_subject_positive_edges_summary_value</span><span class="p">]</span>
<span class="n">test_subject_variable_negative_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">test_subject_negative_edges_summary_value</span><span class="p">]</span>

<span class="c1"># Test the linear model for the</span>
<span class="c1"># positive edges summary values, and</span>
<span class="c1"># negative one for the leftout subject</span>
<span class="c1"># Fit the model of on the left out subject</span>
<span class="n">behavior_prediction_negative_edges</span> <span class="o">=</span> \
    <span class="n">negative_edge_model_fit</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_subject_variable_positive_edges</span><span class="p">)</span>

<span class="n">behavior_prediction_positive_edges</span> <span class="o">=</span> \
    <span class="n">positive_edge_model_fit</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_subject_variable_negative_edges</span><span class="p">)</span>
</pre></div>
</div>
<p>We predict the language performance for the leftout subject,
based on the model we build on the training set. We predict
his score with the positive and negative summary values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">'The true language performance of the leftout subject </span><span class="si">{}</span><span class="s1"> is </span><span class="si">{}</span><span class="s1">, </span><span class="se">\n</span><span class="s1">'</span>
      <span class="s1">'and the predicted language performance with the positive summary value is </span><span class="si">{}</span><span class="s1">, </span><span class="se">\n</span><span class="s1">'</span>
      <span class="s1">'and with the negative summary value is </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">subjects_list</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:][</span><span class="mi">0</span><span class="p">],</span>
                                                         <span class="n">test_language_score</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                                                         <span class="n">behavior_prediction_positive_edges</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                                         <span class="n">behavior_prediction_negative_edges</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>The true language performance of the leftout subject sub44_av130474 is -3.842357637,
and the predicted language performance with the positive summary value is -8.895740545019963,
and with the negative summary value is -66.94929377308095
</pre></div>
</div>


<h3 id="step-4-repeat-and-prediction-evaluation">Step 4: Repeat and prediction evaluation<a class="headerlink" href="#step-4-repeat-and-prediction-evaluation" title="Permalink to this headline">¶</a></h3>
<p>As we said before, the CPM method build a linear
model on a training set and test it on a test set,
which is reduce here to one sample because of the
cross validation, Leave-One-Out. We detailed above
one iteration only, and you need to repeat the entire
process for the other 24 subjects. Let’s call the
<strong>the true scores</strong> of language performance <span class="math notranslate nohighlight">\({y_{true}}\)</span>,
and <span class="math notranslate nohighlight">\({y_{pred+}}\)</span> the <strong>predicted</strong> language score from the
<strong>positive summary values</strong> <span class="math notranslate nohighlight">\({ \sum_{+}^{}}{}\)</span>, and <span class="math notranslate nohighlight">\({y_{pred-}}\)</span>
the <strong>predicted</strong> language score from the
<strong>negative summary values</strong> <span class="math notranslate nohighlight">\({ \sum_{-}^{}}{}\)</span>. One of the
simplest way of evaluating the accuracy of the CPM method, is
compute <strong>the linear correlation</strong> between the true scores
and predicted scores:</p>
<div class="math notranslate nohighlight">
\[R_{pred+} = corr({y_{true}}, {y_{pred+}})\]</div>
<p>And naturally,</p>
<div class="math notranslate nohighlight">
\[R_{pred-} = corr({y_{true}}, {y_{pred-}})\]</div>
<p>You can consider those correlation coefficient as your <strong>statistic</strong>. The next
and final step, is to asses the prediction significance, affecting a p-value to
each of those correlation coefficient between predicted adn true values. In the call
below, we call the function <a class="reference internal" href="../../conpagnon.machine_learning.html#conpagnon.machine_learning.CPM_method.predict_behavior" title="conpagnon.machine_learning.CPM_method.predict_behavior"><code class="xref py py-func docutils literal notranslate"><span class="pre">conpagnon.machine_learning.CPM_method.predict_behavior()</span></code></a>.
This function run the <strong>entire</strong> prediction process and compute <span class="math notranslate nohighlight">\({R_{pred+}}\)</span>, and
<span class="math notranslate nohighlight">\({R_{pred-}}\)</span>. e choose a more selective significance threshold for
the selection feature step 0.01.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Predict the language performance, with</span>
<span class="c1"># a leave-one-out cross validation:</span>
<span class="n">r_pred_positive</span><span class="p">,</span> <span class="n">r_pred_negative</span><span class="p">,</span> <span class="n">selected_positive_features</span><span class="p">,</span> \
    <span class="n">selected_negative_features</span> <span class="o">=</span> <span class="n">predict_behavior</span><span class="p">(</span>
        <span class="n">vectorized_connectivity_matrices</span><span class="o">=</span><span class="n">vectorized_correlation_matrices</span><span class="p">,</span>
        <span class="n">behavioral_scores</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">language_performance</span><span class="p">),</span>
        <span class="n">selection_predictor_method</span><span class="o">=</span><span class="s1">'correlation'</span><span class="p">,</span>
        <span class="n">significance_selection_threshold</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
        <span class="n">confounding_variables_matrix</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">add_predictive_variables</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">'Correlation between predicted and true scores for the positive model: </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">r_pred_positive</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">'Correlation between predicted and true scores for the negative model: </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">r_pred_negative</span><span class="p">))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Train on subjects # [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
Test on subject # [0]
Train on subjects # [ 0  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
Test on subject # [1]
Train on subjects # [ 0  1  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
Test on subject # [2]
Train on subjects # [ 0  1  2  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
Test on subject # [3]
Train on subjects # [ 0  1  2  3  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
Test on subject # [4]
Train on subjects # [ 0  1  2  3  4  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
Test on subject # [5]
Train on subjects # [ 0  1  2  3  4  5  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
Test on subject # [6]
Train on subjects # [ 0  1  2  3  4  5  6  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
Test on subject # [7]
Train on subjects # [ 0  1  2  3  4  5  6  7  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
Test on subject # [8]
Train on subjects # [ 0  1  2  3  4  5  6  7  8 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
Test on subject # [9]
Train on subjects # [ 0  1  2  3  4  5  6  7  8  9 11 12 13 14 15 16 17 18 19 20 21 22 23 24]
Test on subject # [10]
Train on subjects # [ 0  1  2  3  4  5  6  7  8  9 10 12 13 14 15 16 17 18 19 20 21 22 23 24]
Test on subject # [11]
Train on subjects # [ 0  1  2  3  4  5  6  7  8  9 10 11 13 14 15 16 17 18 19 20 21 22 23 24]
Test on subject # [12]
Train on subjects # [ 0  1  2  3  4  5  6  7  8  9 10 11 12 14 15 16 17 18 19 20 21 22 23 24]
Test on subject # [13]
Train on subjects # [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 15 16 17 18 19 20 21 22 23 24]
Test on subject # [14]
Train on subjects # [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 16 17 18 19 20 21 22 23 24]
Test on subject # [15]
Train on subjects # [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 17 18 19 20 21 22 23 24]
Test on subject # [16]
Train on subjects # [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 18 19 20 21 22 23 24]
Test on subject # [17]
Train on subjects # [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 19 20 21 22 23 24]
Test on subject # [18]
Train on subjects # [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 20 21 22 23 24]
Test on subject # [19]
Train on subjects # [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 21 22 23 24]
Test on subject # [20]
Train on subjects # [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 22 23 24]
Test on subject # [21]
Train on subjects # [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 23 24]
Test on subject # [22]
Train on subjects # [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 24]
Test on subject # [23]
Train on subjects # [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23]
Test on subject # [24]
Correlation between predicted and true scores for the positive model: 0.27206717651340484
Correlation between predicted and true scores for the negative model: -0.2832086311804699
</pre></div>
</div>


<h3 id="step-5-assessment-of-prediction-significance">Step 5: Assessment of prediction significance<a class="headerlink" href="#step-5-assessment-of-prediction-significance" title="Permalink to this headline">¶</a></h3>
<p>We will use <strong>permutation testing</strong> to generate a empirical
null distribution of <span class="math notranslate nohighlight">\({R_{pred+}}\)</span>, and <span class="math notranslate nohighlight">\({R_{pred-}}\)</span>
coefficient, measuring the prediction accuracy of the CPM method.
Specifically, permutation is done by preserving the structure
of the connectivity matrices but randomly reassigning behavioral scores.
After the true value of <span class="math notranslate nohighlight">\({R_{pred+}}\)</span>, and <span class="math notranslate nohighlight">\({R_{pred-}}\)</span> are
calculated, we can <strong>randomly</strong> assign language performance to different
subjects, breaking the true relationship between the functional connectivity
and the language performance. Then, with the shuffled language performance
scores we call the <code class="docutils literal notranslate"><span class="pre">predict_behavior()</span></code> function again, computing new
values of the correlation between the predicted scores and the true scores.
We repeat this process for a good number of times, like 10,000 to have
pretty good estimation of the null distribution of of <span class="math notranslate nohighlight">\({R_{pred+}}\)</span>,
and <span class="math notranslate nohighlight">\({R_{pred-}}\)</span>. Finally, for each of those coefficient we can
estimate the <strong>p-value</strong>, by computing the number of times that the sampled
permutation are greater of equal to the true prediction, and divided it by
the number of permutations:</p>
<div class="math notranslate nohighlight">
\[P_{pred+} = (length: R_{permuted} &gt; R_{pred+}) / (N + 1)\]</div>
<p>Where <span class="math notranslate nohighlight">\(N\)</span> is the total number of permutations.</p>
<p>In the example below, we will assess the significance of
the previously computed <span class="math notranslate nohighlight">\({R_{pred+}}\)</span>,
and <span class="math notranslate nohighlight">\({R_{pred-}}\)</span> with 1000 permutations for the sake
of computation time, but in general, at least 10,000 permutations
is recommended.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Number of permutations</span>
<span class="n">n_permutations</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="c1"># Build a n_permutations time</span>
<span class="c1"># shuffled language performance array,</span>
<span class="c1"># for increase the performance</span>
<span class="n">behavioral_scores_permutation_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="n">language_performance</span><span class="p">)</span>
                                                            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_permutations</span><span class="p">)]))</span>
<span class="c1"># Predict the behavior, with</span>
<span class="c1"># a reassigned language performance</span>
<span class="c1"># at each permutation iteration</span>
<span class="n">tic_</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">results_perm</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="s2">"multiprocessing"</span><span class="p">)(</span><span class="n">delayed</span><span class="p">(</span><span class="n">predict_behavior</span><span class="p">)(</span>
    <span class="n">vectorized_connectivity_matrices</span><span class="o">=</span><span class="n">vectorized_correlation_matrices</span><span class="p">,</span>
    <span class="n">behavioral_scores</span><span class="o">=</span><span class="n">behavioral_scores_permutation_matrix</span><span class="p">[</span><span class="n">n_perm</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
    <span class="n">selection_predictor_method</span><span class="o">=</span><span class="s1">'correlation'</span><span class="p">,</span>
    <span class="n">significance_selection_threshold</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
    <span class="n">confounding_variables_matrix</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">add_predictive_variables</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">n_perm</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_permutations</span><span class="p">))</span>
<span class="n">tac_</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">T_</span> <span class="o">=</span> <span class="n">tac_</span> <span class="o">-</span> <span class="n">tic_</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[Parallel(n_jobs=6)]: Using backend MultiprocessingBackend with 6 concurrent workers.
[Parallel(n_jobs=6)]: Done  38 tasks      | elapsed:   21.6s
[Parallel(n_jobs=6)]: Done 188 tasks      | elapsed:  1.8min
[Parallel(n_jobs=6)]: Done 438 tasks      | elapsed:  4.1min
[Parallel(n_jobs=6)]: Done 788 tasks      | elapsed:  7.5min
[Parallel(n_jobs=6)]: Done 1000 out of 1000 | elapsed:  9.4min finished
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>We use the <strong>joblib</strong> library to distribute
the computation among multiple core. The output
is a list, with two elements: the null distribution
for <span class="math notranslate nohighlight">\({R_{pred+}}\)</span>, and the null distribution
for <span class="math notranslate nohighlight">\({R_{pred-}}\)</span>.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">null_distribution</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">results_perm</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">results_perm</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_permutations</span><span class="p">)])</span>

<span class="c1"># Compute p-value for the positive and</span>
<span class="c1"># negative distribution</span>
<span class="n">positive_null_distribution</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">null_distribution</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">negative_null_distribution</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">null_distribution</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>

<span class="n">p_positive</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">positive_null_distribution</span> <span class="o">&gt;</span> <span class="n">r_pred_positive</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">n_permutations</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">p_negative</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">negative_null_distribution</span> <span class="o">&gt;</span> <span class="n">r_pred_negative</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">n_permutations</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">'Positive model p-value: </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p_positive</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'Negative model p-value: </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p_negative</span><span class="p">))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Positive model p-value: 0.12387612387612387
Negative model p-value: 0.7582417582417582
</pre></div>
</div>



<h2 id="visualize-null-distribution-and-selected-features">Visualize null distribution, and selected features<a class="headerlink" href="#visualize-null-distribution-and-selected-features" title="Permalink to this headline">¶</a></h2>
<p>The previously computed p-value show a value superior
than the classical Type-I error rate, for example 0.05,
and hence cannot be considered as statically significant.
We can always visualize the null distribution of both
<span class="math notranslate nohighlight">\({R_{pred+}}\)</span>, and <span class="math notranslate nohighlight">\({R_{pred6}}\)</span>, and
how far away we got from the 95% percentile of the
distributions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the null distribution of the</span>
<span class="c1"># predicted correlation for the positive</span>
<span class="c1"># summary values model</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">positive_null_distribution</span><span class="p">,</span> <span class="s1">'auto'</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">'bar'</span><span class="p">,</span> <span class="n">normed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
         <span class="n">edgecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Null distribution of predicted correlation for positive features model </span><span class="se">\n</span><span class="s1">'</span>
          <span class="s1">'R_pos = </span><span class="si">{}</span><span class="s1">, p_pos = </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">r_pred_positive</span><span class="p">,</span> <span class="n">p_positive</span><span class="p">))</span>
<span class="n">R_positive_thresh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">positive_null_distribution</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mi">95</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">r_pred_positive</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'red'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">R_positive_thresh</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'black'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">'True predicted correlation'</span><span class="p">,</span> <span class="s1">'95% threshold correlation'</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Plot the null distribution of the</span>
<span class="c1"># predicted correlation for the negative</span>
<span class="c1"># summary values model</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">negative_null_distribution</span><span class="p">,</span> <span class="s1">'auto'</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">'bar'</span><span class="p">,</span> <span class="n">normed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
         <span class="n">edgecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Null distribution of predicted correlation for negative features model </span><span class="se">\n</span><span class="s1">'</span>
          <span class="s1">'R_neg = </span><span class="si">{}</span><span class="s1">, p_neg = </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">r_pred_negative</span><span class="p">,</span> <span class="n">p_negative</span><span class="p">))</span>
<span class="n">R_negative_thresh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">negative_null_distribution</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mi">95</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">r_pred_negative</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'blue'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">R_negative_thresh</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'black'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">'True predicted correlation'</span><span class="p">,</span> <span class="s1">'95% threshold correlation'</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img alt="../../_images/sphx_glr_plot_connectome_predictive_modelling_001.png" class="sphx-glr-multi-img" src="../../_images/sphx_glr_plot_connectome_predictive_modelling_001.png"/>
</li>
<li><img alt="../../_images/sphx_glr_plot_connectome_predictive_modelling_002.png" class="sphx-glr-multi-img" src="../../_images/sphx_glr_plot_connectome_predictive_modelling_002.png"/>
</li>
</ul>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/media/dhaif/Samsung_T5/Work/Programs/ConPagnon/examples/04_Advanced_Statistical_Analyses/plot_connectome_predictive_modelling.py:466: MatplotlibDeprecationWarning:
The 'normed' kwarg was deprecated in Matplotlib 2.1 and will be removed in 3.1. Use 'density' instead.
  edgecolor='black')
/media/dhaif/Samsung_T5/Work/Programs/ConPagnon/examples/04_Advanced_Statistical_Analyses/plot_connectome_predictive_modelling.py:474: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
/media/dhaif/Samsung_T5/Work/Programs/ConPagnon/examples/04_Advanced_Statistical_Analyses/plot_connectome_predictive_modelling.py:481: MatplotlibDeprecationWarning:
The 'normed' kwarg was deprecated in Matplotlib 2.1 and will be removed in 3.1. Use 'density' instead.
  edgecolor='black')
/media/dhaif/Samsung_T5/Work/Programs/ConPagnon/examples/04_Advanced_Statistical_Analyses/plot_connectome_predictive_modelling.py:489: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
</pre></div>
</div>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p>Remember that 1000 permutations is
<strong>not</strong> enough to estimate the
null distribution !</p>
</div>
<p>Finally you can retrieve easily the index of the selected
regions that goes into the computation of the summary
values, with the variables <code class="docutils literal notranslate"><span class="pre">selected_positive_features</span></code>,
and <code class="docutils literal notranslate"><span class="pre">selected_negative_features</span></code>. Those variable store
the selected features <strong>for each iteration</strong>. Because of the
nature of the cross-validation, the set of feature can differ
from one iteration to another in the cross-validation loop.
The conservative way of dealing with this, is to compute
<strong>the intersection</strong> between the selected features array.
After that, we can reconstruct the selected features vector
into a connectivity matrices structure for plotting it. For
example, for the <strong>positive summary value</strong> model:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># We re-build the array of selected features</span>
<span class="c1"># for both the positive model</span>
<span class="n">positive_features_arrays</span> <span class="o">=</span> <span class="n">vec_to_sym_matrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">selected_positive_features</span><span class="p">),</span>
                                             <span class="n">diagonal</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">vectorized_correlation_matrices</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                                                <span class="mi">72</span><span class="p">)))</span>

<span class="c1"># Find intersection node by summing all edges across subjects</span>
<span class="n">positive_sum_mask</span> <span class="o">=</span> <span class="n">positive_features_arrays</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">positive_sum_mask</span><span class="p">[</span><span class="n">positive_sum_mask</span> <span class="o">!=</span> <span class="n">vectorized_correlation_matrices</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># Finally plot the selected features matrices</span>
<span class="n">plot_matrix</span><span class="p">(</span><span class="n">matrix</span><span class="o">=</span><span class="n">positive_sum_mask</span><span class="p">,</span>
            <span class="n">mpart</span><span class="o">=</span><span class="s1">'lower'</span><span class="p">,</span>
            <span class="n">colormap</span><span class="o">=</span><span class="s1">'Reds'</span><span class="p">,</span>
            <span class="n">linecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span>
            <span class="n">title</span><span class="o">=</span><span class="s1">'Common edges with positive correlation with behavior'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/sphx_glr_plot_connectome_predictive_modelling_003.png" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_connectome_predictive_modelling_003.png"/>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/media/dhaif/Samsung_T5/Work/Programs/ConPagnon/examples/04_Advanced_Statistical_Analyses/plot_connectome_predictive_modelling.py:527: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 9 minutes  29.244 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-examples-04-advanced-statistical-analyses-plot-connectome-predictive-modelling-py">
<div class="sphx-glr-download docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/f4ec5f4e183520bf18183b7115a64207/plot_connectome_predictive_modelling.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_connectome_predictive_modelling.py</span></code></a></p>
</div>
<div class="sphx-glr-download docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/a01cca96c791d90ec0e9f77e2585a555/plot_connectome_predictive_modelling.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_connectome_predictive_modelling.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>




          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="plot_discriminative_connection_identification.html" title="Discriminative connection identification"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> Discriminative connection identification </span>
              </div>
            </a>
          
          
            <a href="../05_utilities/plot_selection_of_data.html" title="Manipulation of the data dictionary"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> Manipulation of the data dictionary </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2016 - 2020. Created by Dhaif BEKHA..
              
          </div>
            Last updated on
              May 13, 2020.
            <br/>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 3.0.3.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>