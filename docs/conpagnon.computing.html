
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="_static/javascripts/modernizr.js"></script>
  
  
  
    <title>conpagnon.computing package &#8212; ConPagnon 2.0</title>
    <link rel="stylesheet" href="_static/material.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="_static/gallery.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=red data-md-color-accent=blue>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#conpagnon.computing" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="index.html" title="ConPagnon 2.0"
           class="md-header-nav__button md-logo">
          
              <img src="_static/logo_conpagnon_small_header.png" height="26"
                   alt="ConPagnon 2.0 logo">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">ConPagnon 2.0</span>
          <span class="md-header-nav__topic"> conpagnon.computing package </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="search.html" method="GET" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/ConPagnon/conpagnon" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    ConPagnon
  </div>
</a>
          </div>
        </div>
      
      
  
  <script src="_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = "_static/versions.json",
        target_loc = "../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="index.html" title="ConPagnon 2.0" class="md-nav__button md-logo">
      
        <img src="_static/logo_conpagnon_small_header.png" alt=" logo" width="48" height="48">
      
    </a>
    <a href="index.html"
       title="ConPagnon 2.0">ConPagnon 2.0</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/ConPagnon/conpagnon" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    ConPagnon
  </div>
</a>
    </div>
  
  

  
  
  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
      <a href="install.html" class="md-nav__link">Installing ConPagnon</a>
      
    </li>
    <li class="md-nav__item">
    
      <a href="contributing.html" class="md-nav__link">Contributing to ConPagnon</a>
      
    </li>
    <li class="md-nav__item">
    
      <a href="examples/index.html" class="md-nav__link">ConPagnon usage examples</a>
      
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                

<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#conpagnon-computing--page-root" class="md-nav__link">conpagnon.computing package</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#submodules" class="md-nav__link">Submodules</a>
        </li>
        <li class="md-nav__item"><a href="#module-conpagnon.computing.compute_connectivity_matrices" class="md-nav__link">conpagnon.computing.compute_connectivity_matrices module</a>
        </li>
        <li class="md-nav__item"><a href="#module-conpagnon.computing" class="md-nav__link">Module contents</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="_sources/conpagnon.computing.rst.txt">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  
<h1 id="conpagnon-computing--page-root">conpagnon.computing package<a class="headerlink" href="#conpagnon-computing--page-root" title="Permalink to this headline">¶</a></h1>

<h2 id="submodules">Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>


<span id="conpagnon-computing-compute-connectivity-matrices-module"></span><h2 id="module-conpagnon.computing.compute_connectivity_matrices">conpagnon.computing.compute_connectivity_matrices module<a class="headerlink" href="#module-conpagnon.computing.compute_connectivity_matrices" title="Permalink to this headline">¶</a></h2>
<p>Created on Tue Sep 19 17:02:19 2017</p>
<p>ComPagnon 2.0</p>
<p>@author: Dhaif BEKHA</p>
<dl class="py function">
<dt id="conpagnon.computing.compute_connectivity_matrices.create_connectivity_mask">
<code class="sig-prename descclassname">conpagnon.computing.compute_connectivity_matrices.</code><code class="sig-name descname">create_connectivity_mask</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">time_series_dictionary</span></em>, <em class="sig-param"><span class="n">groupes</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/conpagnon/computing/compute_connectivity_matrices.html#create_connectivity_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#conpagnon.computing.compute_connectivity_matrices.create_connectivity_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Create boolean mask for each subjects accounting
for discarded roi if they exist.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time_series_dictionary</strong> (<em>dict</em>) – <dl>
<dt>The time series dictionary structured as follow:</dt><dd><ul>
<li><p>The first keys levels is the different groupes.</p></li>
<li><p>The second keys levels is the subjects IDs</p></li>
<li><p>The third levels is two keys : ‘time_series’ containing the</p></li>
</ul>
<p>subject time series in an array of shape (number of regions, number of time points)
A key ‘discarded_rois’ containing an array of the index of ROIs
where the corresponding labels is ‘void’. If no void labels is detected,
then the array is empty.</p>
</dd>
</dl>
</p></li>
<li><p><strong>groupes</strong> (<em>list</em>) – The list of groups in the study.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>output</strong> – The same time series dictionary with a field called ‘masked_array’ for
each subjects. A masked array is a boolean mask accounting for discarded
rois, True for a discarded rois, and False elsewhere.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If ‘discarded_rois’ is empty the mask is False at every position
in the array.
Almost all the operation in ConPagnon accounts for discarded rois with
masked array via the dedicated module in NumPy.</p>
</dd></dl>
<dl class="py function">
<dt id="conpagnon.computing.compute_connectivity_matrices.extract_sub_connectivity_matrices">
<code class="sig-prename descclassname">conpagnon.computing.compute_connectivity_matrices.</code><code class="sig-name descname">extract_sub_connectivity_matrices</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">subjects_connectivity_matrices</span></em>, <em class="sig-param"><span class="n">kinds</span></em>, <em class="sig-param"><span class="n">regions_index</span></em>, <em class="sig-param"><span class="n">vectorize</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">discard_diagonal</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/conpagnon/computing/compute_connectivity_matrices.html#extract_sub_connectivity_matrices"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#conpagnon.computing.compute_connectivity_matrices.extract_sub_connectivity_matrices" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract sub matrices given region index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subjects_connectivity_matrices</strong> (<em>dict</em>) – The dictionnary containing for each subjects, for each group and kind, the
connectivity matrices, of shape (n_features, n_features), and also
the boolean mask array indicating the discarded roi.</p></li>
<li><p><strong>kinds</strong> (<em>list</em>) – The list of kinds.</p></li>
<li><p><strong>regions_index</strong> (<em>list</em><em>, or </em><em>1D numpy.array of shape</em><em> (</em><em>number of indices</em><em>, </em><em>)</em>) – The list of index of regions you want to extract the connectivity. The
region index also correspond to the index of ROIs in the 4D reference
atlas of the study.</p></li>
<li><p><strong>vectorize</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the extracted sub-matrices are vectorized, keeping
the diagonal of the matrix, and the corresponding boolean
mask.</p></li>
<li><p><strong>discard_diagonal</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the diagonal is discard when the extracted connectivity matrices are vectorized.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>output</strong> – A dictionnary containing for each group and kinds, for each subject
the extract sub-matrice, and the corresponding boolean mask.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="conpagnon.computing.compute_connectivity_matrices.group_mean_connectivity">
<code class="sig-prename descclassname">conpagnon.computing.compute_connectivity_matrices.</code><code class="sig-name descname">group_mean_connectivity</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">subjects_connectivity_matrices</span></em>, <em class="sig-param"><span class="n">kinds</span></em>, <em class="sig-param"><span class="n">axis</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/conpagnon/computing/compute_connectivity_matrices.html#group_mean_connectivity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#conpagnon.computing.compute_connectivity_matrices.group_mean_connectivity" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Compute the mean connectivity matrices for each kind accounting for masked rois.</dt><dd><p>Read the notes for the tangent space !</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subjects_connectivity_matrices</strong> (<em>dict</em>) – <dl>
<dt>A multi-levels dictionnary organised as follow :</dt><dd><blockquote>
<div><ul>
<li><p>The first keys levels is the different groupes in the study.</p></li>
</ul>
</div></blockquote>
<ul>
<li><p>The second keys levels is the subjects IDs</p></li>
<li><p>The third levels is the different kind matrices</p></li>
</ul>
<p>for each subjects, a ‘discarded_rois’ key for the
discarded rois array index, a ‘masked_array’ key containing
the array of Boolean of True for the discarded_rois index, and False
elsewhere.</p>
</dd>
</dl>
</p></li>
<li><p><strong>kinds</strong> (<em>list</em>) – List of kinds you want the mean connectivity. Choices
are ‘correlation’, ‘tangent’, ‘covariances’, ‘precision’, ‘partial
correlation’. Off course, the kind should be in the subjects_connectivity_matrices
dictionnary.</p></li>
<li><p><strong>axis</strong> (<em>int</em><em>, </em><em>optional</em>) – The axis you want to compute the mean, the subjects axis. Default is 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><strong>output</strong> –</p>
<dl>
<dt>A multi-levels dictionnary organised as follow :</dt><dd><ul class="simple">
<li><p>The first keys levels is the different groups in the study.</p></li>
<li><p>The second keys levels is the mean connectivity matrices for</p></li>
</ul>
<p>the different kinds. They are array of shape (number of regions , number of regions)
if vectorize is False, and shape (n_columns * (n_columns + 1) /2) else.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#conpagnon.computing.compute_connectivity_matrices.individual_connectivity_matrices" title="conpagnon.computing.compute_connectivity_matrices.individual_connectivity_matrices"><code class="xref py py-func docutils literal notranslate"><span class="pre">individual_connectivity_matrices()</span></code></a></dt><dd><p>These function returned a organised</p>
</dd>
</dl>
<p><code class="xref py py-func docutils literal notranslate"><span class="pre">dictionnary()</span></code>, <code class="xref py py-func docutils literal notranslate"><span class="pre">simply()</span></code></p>
</div>
<p class="rubric">Notes</p>
<p>When computing the mean, we account for the ‘discarded_rois’ entries. That mean
when the value is True in the masked_array, we discard the rois for the corresponding
subject in the derivation of the mean.
When I compute the mean in the tangent space, it’s a arithmetic mean. This
mean matrix is in the tangent space, that is NOT in the same space as correlation or partial correlation matrix.
Be careful with the interpretation !!
That said, the tangent space is defined at ONE point in the manifold of symmetric matrices.
This point is the geometric mean for the POOLED groups if multiple group are studied !</p>
</dd></dl>
<dl class="py function">
<dt id="conpagnon.computing.compute_connectivity_matrices.individual_connectivity_matrices">
<code class="sig-prename descclassname">conpagnon.computing.compute_connectivity_matrices.</code><code class="sig-name descname">individual_connectivity_matrices</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">time_series_dictionary</span></em>, <em class="sig-param"><span class="n">kinds</span></em>, <em class="sig-param"><span class="n">covariance_estimator</span></em>, <em class="sig-param"><span class="n">vectorize</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">discarding_diagonal</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">z_fisher_transform</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/conpagnon/computing/compute_connectivity_matrices.html#individual_connectivity_matrices"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#conpagnon.computing.compute_connectivity_matrices.individual_connectivity_matrices" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the connectivity matrices for groups of subjects</p>
<p>This function computes connectivity matrices for different metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time_series_dictionary</strong> (<em>dict</em>) – <dl>
<dt>A multi-levels dictionnary organised as follow :</dt><dd><ul>
<li><p>The first keys levels is the different groupes in the study.</p></li>
<li><p>The second keys levels is the subjects IDs</p></li>
<li><p>The third levels is two keys : ‘time_series’ containing the</p></li>
</ul>
<p>subject time series in an array of shape (number of regions, number of time points)
A key ‘discarded_rois’ containing an array of the index of ROIs
where the corresponding labels is ‘void’. If no void labels is detected,
then the array should be empty.</p>
</dd>
</dl>
</p></li>
<li><p><strong>kinds</strong> (<em>list</em>) – List of the different metrics you want to compute the
connectivity matrices. Choices are ‘tangent’, ‘correlation’,
‘partial correlation’, ‘covariance’, ‘precision’.</p></li>
<li><p><strong>covariance_estimator</strong> (<em>estimator object</em>) – All the kinds  are based on derivation of covariances matrices. You need
to precise the estimator, see Notes.</p></li>
<li><p><strong>vectorize</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the connectivity matrices are reshape into 1D arrays of
the vectorized lower part of the matrices. Useful for classification,
regression…
Default is False.</p></li>
<li><p><strong>z_fisher_transform</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the z fisher transform is apply to all
the connectivity matrices. Default is False</p></li>
<li><p><strong>discarding_diagonal</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the diagonal is discarded in
the vectorization process. Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><strong>output</strong> –</p>
<dl>
<dt>A multi-levels dictionnary organised as follow :</dt><dd><ul class="simple">
<li><p>The first keys levels is the different groupes in the study.</p></li>
<li><p>The second keys levels is the subjects IDs</p></li>
<li><p>The third levels contain multiple keys : multiple</p></li>
</ul>
<p>kind keys containing the corresponding kind matrix.
a ‘discarded_rois’ key containing the index of discarded
rois.
Finally you should find a ‘masked_array’ key : This key
contains a array of Boolean, shape (numbers of regions, numbers of regions)
where the value are True for the index in ‘discarded_rois’ array, and False
elsewhere. See Note for further details. The diagonal of the
matrix are saved for each kind too in a dedicated field.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#conpagnon.computing.compute_connectivity_matrices.time_series_extraction" title="conpagnon.computing.compute_connectivity_matrices.time_series_extraction"><code class="xref py py-func docutils literal notranslate"><span class="pre">time_series_extraction()</span></code></a>, <a class="reference internal" href="#conpagnon.computing.compute_connectivity_matrices.time_series_extraction_with_individual_atlases" title="conpagnon.computing.compute_connectivity_matrices.time_series_extraction_with_individual_atlases"><code class="xref py py-func docutils literal notranslate"><span class="pre">time_series_extraction_with_individual_atlases()</span></code></a></p>
</div>
<p class="rubric">Notes</p>
<p>Covariances estimator are estimators compute in the scikit-learn library.
Multiple estimator can be found in the module sklearn.covariance, popular
choices are the Ledoit-Wolf estimator, or the OAS estimator.
In the output dictionnary, each subjects have a masked array of boolean. The
masked will be useful when computing the mean connectivity matrices, we will
account the discarded rois in the derivation. For the statistical test you might
want perform, it will be useful too, to discarded those rois. A True value is
a masked roi, False elsewhere.
For the tangent kind, the derivation of individual matrices need to be
made on the POOLED GROUPS which is performed here.
The derivation of connectivity matrices are based on Nilearn functions. I
encourage the user to read the following docstring of important functions :
nilearn.connectome.ConnectivityMeasure</p>
<p class="rubric">References</p>
<dl>
<dt>For the use of tangent :</dt><dd><dl class="footnote brackets">
<dt class="label" id="id1"><span class="brackets">1</span></dt>
<dd><ol class="upperalpha simple" start="7">
<li><p>Varoquaux et al. “Detection of brain functional-connectivity</p></li>
</ol>
</dd>
</dl>
<p>difference in post-stroke patients using group-level covariance modeling”, MICCAI 2010</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="conpagnon.computing.compute_connectivity_matrices.inter_network_subjects_connectivity_matrices">
<code class="sig-prename descclassname">conpagnon.computing.compute_connectivity_matrices.</code><code class="sig-name descname">inter_network_subjects_connectivity_matrices</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">subjects_individual_matrices_dictionnary</span></em>, <em class="sig-param"><span class="n">groupes</span></em>, <em class="sig-param"><span class="n">kinds</span></em>, <em class="sig-param"><span class="n">atlas_file</span></em>, <em class="sig-param"><span class="n">sheetname</span></em>, <em class="sig-param"><span class="n">network_column_name</span></em>, <em class="sig-param"><span class="n">roi_indices_column_name</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/conpagnon/computing/compute_connectivity_matrices.html#inter_network_subjects_connectivity_matrices"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#conpagnon.computing.compute_connectivity_matrices.inter_network_subjects_connectivity_matrices" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute for each subjects, the inter network connectivity matrices</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subjects_individual_matrices_dictionnary</strong> (<em>dict</em>) – The subjects connectivity matrices dictionnary for each groupes, and kind in the study.</p></li>
<li><p><strong>groupes</strong> (<em>list</em>) – The list of groups in the study</p></li>
<li><p><strong>kinds</strong> (<em>list</em>) – The list of kinds in the study</p></li>
<li><p><strong>atlas_file</strong> (<em>string</em>) – The full path to an excel file containing information on the atlas</p></li>
<li><p><strong>network_column_name</strong> (<em>string</em>) – The name of the column in the excel file containing the network label for each roi</p></li>
<li><p><strong>roi_indices_column_name</strong> – The name of the column in the excel file containing the index of each ROI in the 4D atlas file.</p></li>
<li><p><strong>sheetname</strong> (<em>string</em>) – The name of the active sheet in the excel file</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>output</strong> – The subjects inter network connectivity matrices dictionnary, for each group and kinds. Each matrices
should have shape (number of network, number of network).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The inter-network connectivity is simply defined as the mean of all possible
connection between a network pair. We also account for the possible discarded rois
in one or both the network by computing the mean on a masked array structure, that is,
the inter-network coefficient of interest, along with the corresponding value of the masked
array.</p>
<p class="rubric">References</p>
<p>This inter-network composite score is used in the following references :</p>
<dl class="footnote brackets">
<dt class="label" id="id2"><span class="brackets">1</span></dt>
<dd><p>M. Brier, “Loss of Intranetwork and Internetwork Resting State Functional Connections with Alzheimer’s
Disease Progression” The Journal of Neuroscience, 2012.</p>
</dd>
<dt class="label" id="id3"><span class="brackets">2</span></dt>
<dd><p>P. Wang, “Aberrant intra- and inter-network connectivity architectures in Alzheimer’s disease and mild
cognitive impairment”, Nature Publishing Group, 2015.</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="conpagnon.computing.compute_connectivity_matrices.intra_network_functional_connectivity">
<code class="sig-prename descclassname">conpagnon.computing.compute_connectivity_matrices.</code><code class="sig-name descname">intra_network_functional_connectivity</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">subjects_individual_matrices_dictionnary</span></em>, <em class="sig-param"><span class="n">groupes</span></em>, <em class="sig-param"><span class="n">kinds</span></em>, <em class="sig-param"><span class="n">atlas_file</span></em>, <em class="sig-param"><span class="n">network_column_name</span></em>, <em class="sig-param"><span class="n">sheetname</span></em>, <em class="sig-param"><span class="n">roi_indices_column_name</span></em>, <em class="sig-param"><span class="n">color_of_network_column</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/conpagnon/computing/compute_connectivity_matrices.html#intra_network_functional_connectivity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#conpagnon.computing.compute_connectivity_matrices.intra_network_functional_connectivity" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute for each subjects, the intra network connectivity for each network in the study.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subjects_individual_matrices_dictionnary</strong> (<em>dict</em>) – The subjects connectivity dictionnary containing connectivity matrices
and corresponding mask array for discarded rois, for each group.</p></li>
<li><p><strong>groupes</strong> (<em>list</em>) – The list of groups in the study</p></li>
<li><p><strong>kinds</strong> (<em>list</em>) – The list of kinds in the study</p></li>
<li><p><strong>atlas_file</strong> (<em>string</em>) – The full path to an excel file containing information on the atlas</p></li>
<li><p><strong>network_column_name</strong> (<em>string</em>) – The name of the column in the excel file containing the network label for each roi</p></li>
<li><p><strong>roi_indices_column_name</strong> (<em>string</em>) – The name of the column in the excel file containing the index of each ROI in the 4D atlas file.</p></li>
<li><p><strong>sheetname</strong> (<em>string</em>) – The name of the active sheet in the excel file</p></li>
<li><p><strong>color_of_network_column</strong> (<em>string</em>) – The name of the columns containing for each roi, the corresponding network color.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>output 1</strong> (<em>dict</em>) – A dictionnary structure containing for each subject and for each network: the network connectivity,
the vectorized array of coefficients of the network without the diagonal, the corresponding vectorized
mask array accounting for discarded rois, the diagonal of the mask array, the masked array structure
of the network, and finally the number of rois in the network.</p></li>
<li><p><strong>output 2</strong> (<em>dict</em>) – A dictionnary network, containing information fetch from the atlas excel file of the atlas.</p></li>
<li><p><strong>output 3</strong> (<em>list</em>) – The network label list.</p></li>
<li><p><strong>output 4</strong> (<em>array of shape (number of network, 3)</em>) – The array containing the color in the normalized RGB space, in the order of the network label list.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The intra connectivity is simply defined as the mean, for each network,
of the coefficient belonging to the network. Because connectivity metrics are symmetric,
we only taking the vectorize part of the network connectivity matrices. We account for discarded roi,
as we compute the mean on a numpy masked array structure, that is the vectorized array
along with the vectorized boolean mask for the current network.</p>
<p class="rubric">References</p>
<p>This intra-network composite scores is used in the following references:</p>
<dl class="footnote brackets">
<dt class="label" id="id4"><span class="brackets">1</span></dt>
<dd><p>M. Brier, “Loss of Intranetwork and Internetwork Resting State Functional Connections with Alzheimer’s
Disease Progression” The Journal of Neuroscience, 2012.</p>
</dd>
<dt class="label" id="id5"><span class="brackets">2</span></dt>
<dd><p>P. Wang, “Aberrant intra- and inter-network connectivity architectures in Alzheimer’s disease and mild
cognitive impairment”, Nature Publishing Group, 2015.</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="conpagnon.computing.compute_connectivity_matrices.mean_of_flatten_connectivity_matrices">
<code class="sig-prename descclassname">conpagnon.computing.compute_connectivity_matrices.</code><code class="sig-name descname">mean_of_flatten_connectivity_matrices</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">subjects_individual_matrices_dictionary</span></em>, <em class="sig-param"><span class="n">groupes</span></em>, <em class="sig-param"><span class="n">kinds</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/conpagnon/computing/compute_connectivity_matrices.html#mean_of_flatten_connectivity_matrices"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#conpagnon.computing.compute_connectivity_matrices.mean_of_flatten_connectivity_matrices" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the flat mean connectivity for each subjects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subjects_individual_matrices_dictionary</strong> (<em>dict</em>) – The subjects connectivity dictionnary containing connectivity matrices
and corresponding mask array for discarded rois, for each group.</p></li>
<li><p><strong>groupes</strong> (<em>list</em>) – The list of groupes in the study</p></li>
<li><p><strong>kinds</strong> (<em>list</em>) – The list of kinds in the study</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>output</strong> – A dictionnary containing for each subject in group, a masked array structure containing
the numerical array of the connectivity coefficient of interest, along with the boolean
mask accounting for discarded rois. The second key, contain the mean of the extracted
connectivity coefficient for each subject, also accounting for discarded rois it they
exist.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The subjects connectivity matrices shouldn’t be vectorized, the shape should
be (n_features, n_features).</p>
</dd></dl>
<dl class="py function">
<dt id="conpagnon.computing.compute_connectivity_matrices.pooled_groups_connectivity">
<code class="sig-prename descclassname">conpagnon.computing.compute_connectivity_matrices.</code><code class="sig-name descname">pooled_groups_connectivity</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">time_series_dictionary</span></em>, <em class="sig-param"><span class="n">kinds</span></em>, <em class="sig-param"><span class="n">covariance_estimator</span></em>, <em class="sig-param"><span class="n">vectorize</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/conpagnon/computing/compute_connectivity_matrices.html#pooled_groups_connectivity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#conpagnon.computing.compute_connectivity_matrices.pooled_groups_connectivity" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute connectivity matrices of pooled groups.</p>
<p>This function simply stack the all the times series of each group in one pooled groups and compute
the connectivity matrices  on the whole group. When computing the tangent kind this function is
called.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time_series_dictionary</strong> (<em>dict</em>) – </p></li>
<li><p><strong>multi-levels dictionnary organised as follow</strong> (<em>A</em>) – <ul>
<li><p>The first keys levels is the different groupes in the study.</p></li>
<li><p>The second keys levels is the subjects IDs</p></li>
<li><p>The third levels is two keys : ‘time_series’ containing the</p></li>
</ul>
<p>subject time series in an array of shape (number of regions, number of time points)
A key ‘discarded_rois’ containing an array of the index of ROIs
where the corresponding labels is ‘void’. If no void labels is detected,
then the array should be empty.</p>
</p></li>
<li><p><strong>kinds</strong> (<em>list</em>) – List of the different metrics you want to compute the
connectivity matrices. Choices are ‘tangent’, ‘correlation’,
‘partial correlation’, ‘covariance’, ‘precision’.</p></li>
<li><p><strong>covariance_estimator</strong> (<em>estimator object</em>) – All the kinds  are based on derivation of covariances matrices. You need
to precise the estimator, see Notes.</p></li>
<li><p><strong>vectorize</strong> (<em>bool</em>) – If True, the connectivity matrices are reshape into 1D arrays of
the vectorized lower part of the matrices. Useful for classification,
regression…
Diagonal are discarded.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul>
<li><p><strong>output 1</strong> (<em>dict</em>) –</p>
<dl>
<dt>A multi-levels dictionnary organised as follow :</dt><dd><ul class="simple">
<li><p>The first level keys is the different kinds</p></li>
<li><p>The second levels is simply a ndimensional array of connectivity</p></li>
</ul>
<p>matrices of shape (number of subjects, number of regions, number of regions)
if vectorize is False, and shape (n_columns * (n_columns + 1) /2) else</p>
</dd>
</dl>
</li>
<li><p><strong>output 2</strong> (<em>list</em>) – The list of subject IDs, in the order of time series computation.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Covariances estimator are estimators compute in the scikit-learn library.
Multiple estimator can be found in the module sklearn.covariance, popular
choices are the Ledoit-Wolf estimator, or the OAS estimator.</p>
</dd></dl>
<dl class="py function">
<dt id="conpagnon.computing.compute_connectivity_matrices.pooled_groups_tangent_mean">
<code class="sig-prename descclassname">conpagnon.computing.compute_connectivity_matrices.</code><code class="sig-name descname">pooled_groups_tangent_mean</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">time_series_dictionary</span></em>, <em class="sig-param"><span class="n">covariance_estimator</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/conpagnon/computing/compute_connectivity_matrices.html#pooled_groups_tangent_mean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#conpagnon.computing.compute_connectivity_matrices.pooled_groups_tangent_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the geometric mean of covariances connectivity matrices for the tangent kind.</p>
<p>The geometric mean is the point in the symmetric manifold matrices spaces
where the tangent space is defined. Therefore it’s make sense for the pooled
groups only.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time_series_dictionary</strong> (<em>dict</em>) – <dl>
<dt>A multi-levels dictionnary organised as follow :</dt><dd><ul>
<li><p>The first keys levels is the different groupes in the study.</p></li>
<li><p>The second keys levels is the subjects IDs</p></li>
<li><p>The third levels is two keys : ‘time_series’ containing the</p></li>
</ul>
<p>subject time series in an array of shape (number of regions, number of time points)
A key ‘discarded_rois’ containing an array of the index of ROIs
where the corresponding labels is ‘void’. If no void labels is detected,
then the array should be empty.</p>
</dd>
</dl>
</p></li>
<li><p><strong>covariance_estimator</strong> (<em>estimator object</em>) – </p></li>
<li><p><strong>the kinds  are based on derivation of covariances matrices. You need</strong> (<em>All</em>) – </p></li>
<li><p><strong>precise the estimator</strong><strong>, </strong><strong>see Notes.</strong> (<em>to</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>output</strong> – The geometric mean a the pooled group.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.array of shape (n_features, n_features)</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#conpagnon.computing.compute_connectivity_matrices.time_series_extraction" title="conpagnon.computing.compute_connectivity_matrices.time_series_extraction"><code class="xref py py-func docutils literal notranslate"><span class="pre">time_series_extraction()</span></code></a>, <a class="reference internal" href="#conpagnon.computing.compute_connectivity_matrices.time_series_extraction_with_individual_atlases" title="conpagnon.computing.compute_connectivity_matrices.time_series_extraction_with_individual_atlases"><code class="xref py py-func docutils literal notranslate"><span class="pre">time_series_extraction_with_individual_atlases()</span></code></a>, <code class="xref py py-func docutils literal notranslate"><span class="pre">These()</span></code>, <code class="xref py py-func docutils literal notranslate"><span class="pre">regions()</span></code>, <code class="xref py py-func docutils literal notranslate"><span class="pre">None()</span></code></p>
</div>
<p class="rubric">Notes</p>
<p>Covariances estimator are estimators compute in the scikit-learn library.
Multiple estimator can be found in the module sklearn.covariance, popular
choices are the Ledoit-Wolf estimator, or the OAS estimator.
For now, we doesnt account for discarded rois for the derivation of the
geometric mean.</p>
</dd></dl>
<dl class="py function">
<dt id="conpagnon.computing.compute_connectivity_matrices.subjects_mean_connectivity_">
<code class="sig-prename descclassname">conpagnon.computing.compute_connectivity_matrices.</code><code class="sig-name descname">subjects_mean_connectivity_</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">subjects_individual_matrices_dictionnary</span></em>, <em class="sig-param"><span class="n">connectivity_coefficient_position</span></em>, <em class="sig-param"><span class="n">kinds</span></em>, <em class="sig-param"><span class="n">groupes</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/conpagnon/computing/compute_connectivity_matrices.html#subjects_mean_connectivity_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#conpagnon.computing.compute_connectivity_matrices.subjects_mean_connectivity_" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute for each subjects, the mean connectivity for some connectivity coefficient in the general subjects
connectivity matrices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subjects_individual_matrices_dictionnary</strong> (<em>dict</em>) – The subjects connectivity dictionnary containing connectivity matrices
and corresponding mask array for discarded rois, for each group.</p></li>
<li><p><strong>connectivity_coefficient_position</strong> (<em>numpy.array of shape</em><em> (</em><em>number of rois</em><em>, </em><em>row_index</em><em>, </em><em>column_index</em><em>)</em>) – The array containing the position in the connectivity matrices of the rois you want
to extract the connectivity coefficients.</p></li>
<li><p><strong>kinds</strong> (<em>list</em>) – The list of kinds.</p></li>
<li><p><strong>groupes</strong> (<em>list</em>) – The list of the two group in the study.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>output</strong> – A dictionnary containing for each subject in group, a masked array structure containing
the numerical array of the connectivity coefficient of interest, along with the boolean
mask accounting for discarded rois. The second key, contain the mean of the extracted
connectivity coefficient for each subject, also accounting for discarded rois it they
exist.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The subjects connectivity matrices shouldn’t be vectorized, the shape should
be (n_features, n_features).</p>
</dd></dl>
<dl class="py function">
<dt id="conpagnon.computing.compute_connectivity_matrices.tangent_space_projection">
<code class="sig-prename descclassname">conpagnon.computing.compute_connectivity_matrices.</code><code class="sig-name descname">tangent_space_projection</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">reference_group</span></em>, <em class="sig-param"><span class="n">group_to_project</span></em>, <em class="sig-param"><span class="n">bootstrap_number</span></em>, <em class="sig-param"><span class="n">bootstrap_size</span></em>, <em class="sig-param"><span class="n">output_directory</span></em>, <em class="sig-param"><span class="n">verif_null</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">correction_method</span><span class="o">=</span><span class="default_value">'bonferroni'</span></em>, <em class="sig-param"><span class="n">alpha</span><span class="o">=</span><span class="default_value">0.05</span></em>, <em class="sig-param"><span class="n">statistic</span><span class="o">=</span><span class="default_value">'t'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/conpagnon/computing/compute_connectivity_matrices.html#tangent_space_projection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#conpagnon.computing.compute_connectivity_matrices.tangent_space_projection" title="Permalink to this definition">¶</a></dt>
<dd><p>Project a group of time series to a space tangent to a reference connectivity matrix.
The reference matrix is derived from a reference times series group. Then, each edges of
the projected matrices is tested regarding the reference group through a one sample t-test
or a simple z-score. The null distribution of edges is derived with bootstrap.
Please, take a look to the reference paper for further a deeper understanding of the
method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reference_group</strong> (<em>numpy.array</em>) – The stack of the vectorized connectivity matrices of shape
(n_subjects, n_features). This is the reference point where
the tangent space will be computed. All tangent connectivity
matrices will be derived regarding this reference set of matrices.</p></li>
<li><p><strong>group_to_project</strong> (<em>numpy.array</em>) – The stack of the vectorized connectivity matrices of shape
(n_subjects, n_features). Each connectivity matrices will be
projected in the tangent space, at the reference matrix of the
reference group.</p></li>
<li><p><strong>bootstrap_number</strong> (<em>int</em>) – The null distribution of each edges is derived trough bootstrapping
of the reference set of matrices. Usually around 500.</p></li>
<li><p><strong>bootstrap_size</strong> (<em>int</em>) – The size of the bootstrapped sample, i.e the number of
subjects to pick from the reference set.</p></li>
<li><p><strong>output_directory</strong> (<em>str</em>) – The full path of the directory for saving the results</p></li>
<li><p><strong>verif_null</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, generate a report choosing a set of 20 random
rois and plot the null distributions in those rois. True
by defaults</p></li>
<li><p><strong>correction_method</strong> (<em>str</em><em>, </em><em>optional</em>) – The correction method used for to correct for
multiple comparison. The default is the classical
bonferroni method. You can choose among all the correction
proposed by the statsmodels library.</p></li>
<li><p><strong>alpha</strong> (<em>float</em><em>, </em><em>optional</em>) – The type I error rate used for the multiple comparison
correction. Set to .05 by defaults.</p></li>
<li><p><strong>statistic</strong> (<em>str</em><em>, </em><em>optional</em>) – The statistic used, a one sample t-test by default. Other choices
are: z, for a simple z-score.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><strong>output</strong> –</p>
<dl>
<dt>A dictionary with the following fields:</dt><dd><ul class="simple">
<li><p>null_distribution: The array containing</p></li>
</ul>
<p>the estimated null distribution for each edges.
- p_values_corrected: The p values, adjusted
after the multiple comparison correction
- reference_group_tangent_mean: The reference
matrix, derived from the mean of the matrices
from the reference group. This is the point
where all matrices are projected.
- reference_group_tangent_matrices: The connectivity
matrices in the tangent space for the reference
group.
- group_to_project_tangent_matrices: The
connectivity matrices in the tangent space
for the projected group
- group_to_project_stats: The chosen
statistic for each subject, each edges
in the projected set of subjects.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id6"><span class="brackets">1</span></dt>
<dd><p>G. Varoquaux et al. “Detection of brain functional-connectivity
difference in post-stroke patients using group-level covariance modeling”, MICCAI 2010</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="conpagnon.computing.compute_connectivity_matrices.time_series_extraction">
<code class="sig-prename descclassname">conpagnon.computing.compute_connectivity_matrices.</code><code class="sig-name descname">time_series_extraction</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">root_fmri_data_directory</span></em>, <em class="sig-param"><span class="n">groupes</span></em>, <em class="sig-param"><span class="n">subjects_id_data_path</span></em>, <em class="sig-param"><span class="n">reference_atlas</span></em>, <em class="sig-param"><span class="n">group_data</span></em>, <em class="sig-param"><span class="n">repetition_time</span></em>, <em class="sig-param"><span class="n">low_pass_filtering</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">high_pass_filtering</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">detrend_signal</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">standardize_signal</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">smooth_signal</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">resampling_target</span><span class="o">=</span><span class="default_value">'data'</span></em>, <em class="sig-param"><span class="n">memory_level</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">nilearn_cache_directory</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/conpagnon/computing/compute_connectivity_matrices.html#time_series_extraction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#conpagnon.computing.compute_connectivity_matrices.time_series_extraction" title="Permalink to this definition">¶</a></dt>
<dd><p>Times series extractions for each subjects on a common atlas.</p>
<p>This function extract time series for each subjects according predefined regions on one common atlas.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>root_fmri_data_directory</strong> (<em>str</em>) – The full path of a root directory containing one or numerous
sub-directories where functional images are.</p></li>
<li><p><strong>groupes</strong> (<em>list</em>) – The list of groups of interest, i.e the name of the
sub-directories containing the functional images you want
to study.</p></li>
<li><p><strong>subjects_id_data_path</strong> (<em>str</em>) – The full path to the data file containing the subjects IDs.</p></li>
<li><p><strong>group_data</strong> (<em>dict</em>) – <dl>
<dt>A multi-levels dictionnary structured as follow :</dt><dd><ul>
<li><p>The first keys level is the different groups</p></li>
</ul>
<p>to study.
- The second level keys is the subjects IDs for
all subjects in each groupes.
- The third level keys contain multiple field :
‘functional_file’ contain the full path to the subject
fmri file, ‘atlas_file’ contain the full path to the
subject atlas, ‘label_file’ the full path to the subject
atlas label, ‘confounds_file’ the full path to the subject
confounds file if they exist, a empty list if not.</p>
</dd>
</dl>
</p></li>
<li><p><strong>reference_atlas</strong> (<em>str</em>) – The full path to the reference atlas which will be used
to extract signals from regions.</p></li>
<li><p><strong>repetition_time</strong> (<em>float</em>) – The repetition time in second, i.e the time between two volumes
in a fmri image.</p></li>
<li><p><strong>low_pass_filtering</strong> (<em>float</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – The low pass frequency in Hz cut-off for filtering the times series.
Default is None.</p></li>
<li><p><strong>high_pass_filtering</strong> (<em>float</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – The high pass frequency in Hz cut-off for filtering the time series.
Default is None</p></li>
<li><p><strong>detrend_signal</strong> (<em>bool</em><em>, </em><em>optional</em>) – Detrend the time series removing the first order moment to the
time series, i.e removing the mean signals to each time series.
Default if True.</p></li>
<li><p><strong>standardize_signal</strong> (<em>bool</em><em>, </em><em>optional</em>) – Set the times series to unit variance
Default is True.</p></li>
<li><p><strong>smooth_signal</strong> (<em>float</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – The full-width half maximum in millimeters of a Gaussian
spatial smoothing to apply to the time series.
Default is None.</p></li>
<li><p><strong>resampling_target</strong> (<em>str</em>) – Gives the reference image which the source image image
will be resample.
Choices are  : {“mask”, “maps”, “data”, None}.
Default is ‘data’.</p></li>
<li><p><strong>memory_level</strong> (<em>int</em><em>, </em><em>optional</em>) – Caching parameters of functions. Default is 1.</p></li>
<li><p><strong>nilearn_cache_directory</strong> (<em>str</em><em> or </em><em>None</em>) – The full path which will contain the folder used to cache
the regions extractions. If None, no cache is performing.
Default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><strong>output</strong> –</p>
<dl>
<dt>A dictionnary structured as follow :</dt><dd><ul class="simple">
<li><p>The first keys levels is the different groupes.</p></li>
<li><p>The second keys levels is the subjects IDs</p></li>
<li><p>The third levels is two keys : ‘time_series’ containing the</p></li>
</ul>
<p>subject time series in an array of shape (number of regions, number of time points)</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-func docutils literal notranslate"><span class="pre">data_architecture.fetch_data()</span></code></dt><dd><p>This function</p>
</dd>
</dl>
<p><code class="xref py py-func docutils literal notranslate"><span class="pre">returned()</span></code>, <code class="xref py py-func docutils literal notranslate"><span class="pre">time()</span></code>, <code class="xref py py-func docutils literal notranslate"><span class="pre">simply()</span></code></p>
</div>
<p class="rubric">Notes</p>
<p>The times series extraction is based on functions contain is the Nilearn
packages. I encourage the users to consult the docstring of the following
function for the detailed mechanism of signal extraction : nilearn.signal.clean,
nilearn.input_data.NiftiMapsMasker.</p>
<p>The subjects IDs file, whatever the format, should not contain any header.
It’s should have a row column of ID for each subjects.</p>
<p class="rubric">References</p>
<p>The Nilearn official documentation on Github :
[1] <a class="reference external" href="http://nilearn.github.io/index.html">http://nilearn.github.io/index.html</a></p>
</dd></dl>
<dl class="py function">
<dt id="conpagnon.computing.compute_connectivity_matrices.time_series_extraction_with_individual_atlases">
<code class="sig-prename descclassname">conpagnon.computing.compute_connectivity_matrices.</code><code class="sig-name descname">time_series_extraction_with_individual_atlases</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">root_fmri_data_directory</span></em>, <em class="sig-param"><span class="n">groupes</span></em>, <em class="sig-param"><span class="n">subjects_id_data_path</span></em>, <em class="sig-param"><span class="n">group_data</span></em>, <em class="sig-param"><span class="n">repetition_time</span></em>, <em class="sig-param"><span class="n">low_pass_filtering</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">high_pass_filtering</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">detrend_signal</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">standardize_signal</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">smooth_signal</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">resampling_target</span><span class="o">=</span><span class="default_value">'data'</span></em>, <em class="sig-param"><span class="n">memory_level</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">nilearn_cache_directory</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/conpagnon/computing/compute_connectivity_matrices.html#time_series_extraction_with_individual_atlases"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#conpagnon.computing.compute_connectivity_matrices.time_series_extraction_with_individual_atlases" title="Permalink to this definition">¶</a></dt>
<dd><p>Times series extractions for each subjects with an individual atlas.</p>
<p>This function extract time series for each subjects according predefined regions in individual atlases.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>root_fmri_data_directory</strong> (<em>str</em>) – The full path of a root directory containing one or numerous
sub-directories where functional images are.</p></li>
<li><p><strong>groupes</strong> (<em>list</em>) – The list of groups of interest, i.e the name of the
sub-directories containing the functional images you want
to study.</p></li>
<li><p><strong>subjects_id_data_path</strong> (<em>str</em>) – The full path to the data file containing the subjects IDs.</p></li>
<li><p><strong>group_data</strong> (<em>dict</em>) – <dl>
<dt>A multi-levels dictionary structured as follow :</dt><dd><ul>
<li><p>The first keys level is the different groups</p></li>
</ul>
<p>to study.
- The second level keys is the subjects IDs for
all subjects in each groupes.
- The third level keys contain multiple field :
‘functional_file’ contain the full path to the subject
fmri file, ‘atlas_file’ contain the full path to the
subject atlas, ‘label_file’ the full path to the subject
atlas label, ‘confounds_file’ the full path to the subject
confounds file if they exist, a empty list if not.</p>
</dd>
</dl>
</p></li>
<li><p><strong>repetition_time</strong> (<em>float</em>) – The repetition time in second, i.e the time between two volumes
in a fmri image.</p></li>
<li><p><strong>low_pass_filtering</strong> (<em>float</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – The low pass frequency in Hz cut-off for filtering the times series.
Default is None.</p></li>
<li><p><strong>high_pass_filtering</strong> (<em>float</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – The high pass frequency in Hz cut-off for filtering the time series.
Default is None</p></li>
<li><p><strong>detrend_signal</strong> (<em>bool</em><em>, </em><em>optional</em>) – Detrend the time series removing the first order moment to the
time series, i.e removing the mean signals to each time series.
Default if True.</p></li>
<li><p><strong>standardize_signal</strong> (<em>bool</em><em>, </em><em>optional</em>) – Set the times series to unit variance
Default is True.</p></li>
<li><p><strong>smooth_signal</strong> (<em>float</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – The full-width half maximum in millimeters of a Gaussian
spatial smoothing to apply to the time series.
Default is None.</p></li>
<li><p><strong>resampling_target</strong> (<em>str</em>) – Gives the reference image which the source image image
will be resample.
Choices are  : {“mask”, “maps”, “data”, None}.
Default is ‘data’.</p></li>
<li><p><strong>memory_level</strong> (<em>int</em><em>, </em><em>optional</em>) – Caching parameters of functions. Default is 1.</p></li>
<li><p><strong>nilearn_cache_directory</strong> (<em>str</em><em> or </em><em>None</em>) – The full path which will contain the folder used to cache
the regions extractions. If None, no cache is performing.
Default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><strong>output</strong> –</p>
<dl>
<dt>A dictionnary structured as follow :</dt><dd><ul class="simple">
<li><p>The first keys levels is the different groupes.</p></li>
<li><p>The second keys levels is the subjects IDs</p></li>
<li><p>The third levels is two keys : ‘time_series’ containing the</p></li>
</ul>
<p>subject time series in an array of shape (number of regions, number of time points)
A key ‘discarded_rois’ containing an array of the index of ROIs
where the corresponding labels is ‘void’. If no void labels is detected,
then the array is empty.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-func docutils literal notranslate"><span class="pre">data_architecture.fetch_data_with_individual_atlases()</span></code></dt><dd><p>This function</p>
</dd>
</dl>
<p><code class="xref py py-func docutils literal notranslate"><span class="pre">returned()</span></code>, <code class="xref py py-func docutils literal notranslate"><span class="pre">time()</span></code>, <code class="xref py py-func docutils literal notranslate"><span class="pre">simply()</span></code></p>
</div>
<p class="rubric">Notes</p>
<p>The times series extraction is based on functions contain is the Nilearn
packages. I encourage the users to consult the docstring of the following
function for the detailed mechanism of signal extraction : nilearn.signal.clean,
nilearn.input_data.NiftiMapsMasker.</p>
<p>The subjects IDs file, whatever the format, should not contain any header.
It’s should have a row column of ID for each subjects.</p>
<p>Remembers that the discarded rois are defined according to their labels
which must be declared as ‘void’ in the subject atlas labels files.</p>
<p class="rubric">References</p>
<p>The Nilearn official documentation on Github :
[1] <a class="reference external" href="http://nilearn.github.io/index.html">http://nilearn.github.io/index.html</a></p>
</dd></dl>


<span id="module-contents"></span><h2 id="module-conpagnon.computing">Module contents<a class="headerlink" href="#module-conpagnon.computing" title="Permalink to this headline">¶</a></h2>
<p>Created on Tue Sep 19 17:10:13 2017</p>
<p>@author: db242421</p>




          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2016 - 2020. Created by Dhaif BEKHA.
              
          </div>
            Last updated on
              May 19, 2020.
            <br/>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 3.0.3.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>